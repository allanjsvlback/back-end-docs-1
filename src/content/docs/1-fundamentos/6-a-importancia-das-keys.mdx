---
title: 'A Importância das Keys'
description: 'Entenda por que as "keys" são essenciais ao renderizar listas em React e como elas ajudam o algoritmo de reconciliação a ser mais eficiente.'
---

import { Aside } from '@astrojs/starlight/components';

Ao trabalhar com listas de dados em React, como ao usar a função `.map()` para renderizar um array, você inevitavelmente encontrará um aviso no console do navegador: `Warning: Each child in a list should have a unique "key" prop.`

Este não é apenas um aviso para ser ignorado. As `keys` são uma ferramenta crucial que você fornece ao React para ajudá-lo a otimizar a renderização de listas dinâmicas.

## O Que São as `keys`?

Uma **`key`** é uma `prop` especial, do tipo string ou número, que você precisa incluir ao criar listas de elementos. A `key` serve como uma **identidade estável** para cada item na lista, permitindo que o React rastreie cada elemento individualmente durante as atualizações.

```jsx
const products = [
  { id: 'p1', name: 'Laptop' },
  { id: 'p2', name: 'Mouse' },
  { id: 'p3', name: 'Teclado' },
];

function ProductList() {
  return (
    <ul>
      {products.map((product) => (
        // A 'key' deve ser atribuída ao elemento mais externo do map.
        <li key={product.id}>
          {product.name}
        </li>
      ))}
    </ul>
  );
}
```

## Como as `keys` Ajudam a Reconciliação?

Lembre-se do [processo de reconciliação](/1-fundamentos/5-o-virtual-dom/): o React compara a árvore do Virtual DOM antiga com a nova para descobrir o que mudou. Quando se trata de listas, as `keys` dão ao React uma maneira de identificar os itens de forma inteligente, em vez de depender apenas de sua ordem.

Imagine uma lista de tarefas. O que acontece se você adicionar uma nova tarefa no **início** da lista?

*   **Sem `keys`:** O React compararia a lista item por item. Ele veria que o conteúdo de cada `<li>` mudou e decidiria atualizar o DOM de todos os elementos da lista. Isso é ineficiente e pode causar problemas, especialmente se os itens da lista tiverem seu próprio `state`.

*   **Com `keys`:** O React usa as `keys` para ver que os itens com as keys `'task-2'` e `'task-3'` ainda existem, eles apenas se moveram para baixo. E um novo item com a key `'task-1'` foi adicionado. Em vez de atualizar todos os itens, ele simplesmente **insere o novo elemento** no DOM, uma operação muito mais rápida e precisa.

<Aside type="note">
As `keys` só precisam ser únicas **entre os irmãos** na mesma lista. Você pode ter as mesmas `keys` em duas listas diferentes sem problemas.
</Aside>

## O Anti-padrão: Usar o Índice do Array como `key`

Uma tentação comum é usar o índice do array como `key`, assim: `map((item, index) => <li key={index}>...</li>)`.

**Isso deve ser evitado**, a menos que sua lista atenda a TODAS as seguintes condições:
1. A lista e seus itens são estáticos (nunca mudam).
2. Os itens da lista não têm IDs estáveis.
3. A lista nunca será reordenada ou filtrada.

**Por que é perigoso?**
O problema é que o índice não identifica o *dado*, mas sim a *posição* do item na lista. Se você reordena ou remove um item do meio da lista, os índices dos itens subsequentes mudam. O React, olhando para a `key` (o índice), vai se confundir e pode associar o estado interno de um componente ao item errado, levando a bugs difíceis de rastrear.

Por exemplo, se você remove o primeiro item, o segundo item passa a ter o `index` `0`. O React pensará que é o mesmo item de antes, mas com conteúdo diferente, em vez de reconhecer que o primeiro item foi removido.

## Escolhendo a `key` Perfeita

A melhor `key` é um identificador que atenda a três critérios:

1.  **Única:** Deve ser única entre todos os irmãos da lista.
2.  **Estável:** Não deve mudar entre as renderizações.
3.  **Significativa:** Deve vir dos seus dados.

O **ID de um item vindo de um banco de dados** (`product.id`, `user.uuid`, etc.) é quase sempre a escolha ideal.

---

Com um bom entendimento de listas e `keys`, estamos prontos para explorar a última peça fundamental da renderização dinâmica em React: a **Renderização Condicional**.
